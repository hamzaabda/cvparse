<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-xl-8">
      <div class="card bg-secondary shadow">
        <div class="card-body">
          <form *ngIf="!editingAdmin" (ngSubmit)="onSubmit()" #adminForm="ngForm">
            <h6 class="heading-small text-muted mb-4 text-center">Add New Admin</h6>
            <div class="row justify-content-center">
              <div class="col-lg-8">
                <div class="form-group">
                  <label for="input-username">Username</label>
                  <input type="text" id="input-username" class="form-control" placeholder="Username" name="username" ngModel required minlength="3" maxlength="20">
                  <div *ngIf="adminForm.controls['username'].invalid && (adminForm.controls['username'].dirty || adminForm.controls['username'].touched)">
                    <small class="text-danger" *ngIf="adminForm.controls['username'].errors.required">Username is required.</small>
                    <small class="text-danger" *ngIf="adminForm.controls['username'].errors.minlength">Username must be at least 3 characters long.</small>
                    <small class="text-danger" *ngIf="adminForm.controls['username'].errors.maxlength">Username cannot exceed 20 characters.</small>
                  </div>
                </div>
              </div>
            </div>
            <div class="row justify-content-center">
              <div class="col-lg-8">
                <div class="form-group">
                  <label for="input-email">Email address</label>
                  <input type="email" id="input-email" class="form-control" placeholder="Email address" name="email" ngModel required email>
                  <div *ngIf="adminForm.controls['email'].invalid && (adminForm.controls['email'].dirty || adminForm.controls['email'].touched)">
                    <small class="text-danger" *ngIf="adminForm.controls['email'].errors.required">Email is required.</small>
                    <small class="text-danger" *ngIf="adminForm.controls['email'].errors.email">Invalid email format.</small>
                  </div>
                </div>
              </div>
            </div>
            <div class="row justify-content-center">
              <div class="col-lg-8">
                <div class="form-group">
                  <label for="input-password">Password</label>
                  <input type="password" id="input-password" class="form-control" placeholder="Password" name="password" ngModel required minlength="6">
                  <div *ngIf="adminForm.controls['password'].invalid && (adminForm.controls['password'].dirty || adminForm.controls['password'].touched)">
                    <small class="text-danger" *ngIf="adminForm.controls['password'].errors.required">Password is required.</small>
                    <small class="text-danger" *ngIf="adminForm.controls['password'].errors.minlength">Password must be at least 6 characters long.</small>
                  </div>
                </div>
              </div>
            </div>
            <div class="row justify-content-center">
              <div class="col-lg-8 text-center">
                <button type="submit" class="btn btn-primary">Add Admin</button>
              </div>
            </div>
          </form>

          <div *ngIf="editingAdmin">
            <h6 class="heading-small text-muted mb-4 text-center">Edit Admin</h6>
            <form (ngSubmit)="saveAdminChanges()" #editForm="ngForm">
              <div class="row justify-content-center">
                <div class="col-lg-8">
                  <div class="form-group">
                    <label for="edit-username">New Username</label>
                    <input type="text" id="edit-username" class="form-control" placeholder="New Username" name="editedUsername" [(ngModel)]="editedAdmin.username" required>
                  </div>
                </div>
              </div>
              <div class="row justify-content-center">
                <div class="col-lg-8">
                  <div class="form-group">
                    <label for="edit-email">New Email address</label>
                    <input type="email" id="edit-email" class="form-control" placeholder="New Email address" name="editedEmail" [(ngModel)]="editedAdmin.email" required>
                  </div>
                </div>
              </div>
              <div class="row justify-content-center">
                <div class="col-lg-8 text-center">
                  <button type="submit" class="btn btn-primary">Save Changes</button>
                  <button type="button" class="btn btn-secondary ml-2" (click)="cancelEdit()">Cancel</button>
                </div>
              </div>
            </form>
          </div>
          
        </div>
      </div>
    </div>
  </div>

  <!-- Affichage du graphique -->
  <div class="row justify-content-center mt-5">
    <div class="col-xl-8">
      <div class="card bg-secondary shadow">
        <div class="card-body">
          <h6 class="heading-small text-muted mb-4 text-center">Users Count Chart</h6>
          <canvas #usersChartCanvas></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Affichage et gestion des administrateurs -->
  <div class="row justify-content-center mt-5">
    <div class="col-xl-8">
      <div class="card bg-secondary shadow">
        <div class="card-body">
          <h6 class="heading-small text-muted mb-4 text-center">Admins</h6>
          <table class="table">
            <thead>
              <tr>
                <th>Username</th>
                <th>Email</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let admin of admins">
                <td>{{ admin.username }}</td>
                <td>{{ admin.email }}</td>
                <td>
                  <button class="btn btn-info btn-sm mr-2" (click)="editAdmin(admin)">Edit</button>
                  <button *ngIf="admin._id" class="btn btn-danger btn-sm" (click)="confirmDelete(admin)">Delete</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
